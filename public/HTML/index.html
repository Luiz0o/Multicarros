<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Multicarros Home</title>
    <link rel="stylesheet" href="/css/responsive.css" />
    <link rel="stylesheet" href="/css/home.css" />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"
    />
    <link
      href="https://fonts.googleapis.com/css2?family=Rajdhani:wght@500;700&display=swap"
      rel="stylesheet"
    />
  </head>
  <body>
    <!-- TOPO FIXO -->
    <header class="topo">
      <div class="topo-logo">
        <img src="/images/multilogo.png" alt="Logo Multicarros" />
      </div>

      <!-- barra de pesquisa centralizada acima do menu -->
      <div class="topo-search">
        <div class="barra-pesquisa-container">
          <i class="fa-solid fa-magnifying-glass icone-pesquisa"></i>
          <input
            type="text"
            class="barra-pesquisa"
            placeholder="Buscar ve√≠culo..."
          />
        </div>
      </div>
      <nav>
        <a href="/HTML/index.html">Home</a>
        <a href="/HTML/financiamento.html">Financiamento</a>
        <a href="/HTML/sobreEmpresa.html">Sobre a Empresa</a>
        <a href="/HTML/contato.html">Contato</a>
        <a href="/HTML/login.html">Entrar</a>
      </nav>
    </header>

    <!-- BANNER -->
    <section class="banner">
      <br />
      <br />
      <h1>Aqui seu pr√≥ximo <span>carro encontra voc√™!</span></h1>
      <p>
        Na Multicarros voc√™ encontra os melhores ve√≠culos com a garantia de bons
        neg√≥cios.
      </p>
      <br />

      <!-- Bot√µes do banner (marcas + a√ß√£o) -->
      <div class="banner-botoes">
        <!-- Bot√£o interativo de marcas -->
        <div class="marcas-container">
          <button id="btnMarcas" class="btn-marcas">
            <i class="fa-solid fa-car"></i> Nossos Modelos
            <i class="fa-solid fa-chevron-down seta"></i>
          </button>
          <ul id="listaMarcas" class="lista-marcas-animada">
            <li><a href="#">Audi</a></li>
            <li><a href="#">BMW</a></li>
            <li><a href="#">Chevrolet</a></li>
            <li><a href="#">Fiat</a></li>
            <li><a href="#">Ford</a></li>
            <li><a href="#">Honda</a></li>
            <li><a href="#">Jeep</a></li>
            <li><a href="#">Peugeot</a></li>
            <li><a href="#">Renault</a></li>
            <li><a href="#">Subaru</a></li>
            <li><a href="#">Toyota</a></li>
            <li><a href="#">Volkswagen</a></li>
          </ul>
        </div>

        <a
          href="https://www.google.com/maps/place/Multicarros/@-15.811896,-48.064726,15z/data=!4m6!3m5!1s0x935a333c90e88e27:0x83aa09beb7b37e9d!8m2!3d-15.811896!4d-48.064726!16s%2Fg%2F1yh8072l_?entry=ttu"
          class="btn"
          >Onde Estamos</a
        >
      </div>
    </section>

    <!-- CARROS -->
    <h2>
      <i class="fa-solid fa-star" style="color: #24aa4c"></i> Carros em Destaque
    </h2>
    <div id="destaqueContainer" class="carros-container">
      <div class="car-card">
        <div class="img-container">
          <img
            src="/images/onix-plus-midnight-(22).webp"
            alt="Chevrolet Onix"
          />
          <span class="badge">Chegou!</span>
        </div>
        <div class="car-info">
          <h2>CHEVROLET ONIX</h2>
          <p class="subtitle">1.0 Flex Manual</p>
          <div class="details">
            <span>üìÖ 2022</span>
            <span>‚è±Ô∏è 36.000 Km</span>
          </div>
          <p class="price">R$ 82.900</p>
          <button
            class="offer-btn"
            onclick="window.location.href='verDetalhes.html'"
          >
            Ver Detalhes
          </button>
        </div>
      </div>
      <!-- üîπ fechamento da se√ß√£o de destaque -->

      <div class="car-card">
        <div class="img-container">
          <img src="/images/Corolla1.jpg" alt="Toyota Corolla XEI" />
          <span class="badge">Chegou!</span>
        </div>
        <div class="car-info">
          <h2>Toyota Corolla XEI</h2>
          <p class="subtitle">2.0 Flex Autom√°tico</p>
          <div class="details">
            <span>üìÖ 2023</span>
            <span>‚è±Ô∏è 71.000 Km</span>
          </div>
          <p class="price">R$ 134.000</p>
          <button class="offer-btn">Ver Detalhes</button>
        </div>
      </div>
    </div>
    <!-- üîπ fechamento da se√ß√£o de destaque -->

    <!-- ESTOQUE DE CARROS -->
    <h2>
      <i class="fa-solid fa-car" style="color: #24aa4c"></i> Ve√≠culos em Estoque
    </h2>
    <div id="estoqueContainer" class="carros-container">
      <div class="car-card">
        <div class="img-container">
          <img
            src="/images/bcad5924b5c214c0faf52777d41c80c1.jpg"
            alt="Honda Civic"
          />
          <span class="badge">Seminovo</span>
        </div>
        <div class="car-info">
          <h2>HONDA CIVIC</h2>
          <p class="subtitle">2.0 Sport CVT</p>
          <div class="details">
            <span>üìÖ 2023</span>
            <span>‚è±Ô∏è 20.000 Km</span>
          </div>
          <p class="price">R$ 124.900</p>
          <button class="offer-btn">Ver Detalhes</button>
        </div>
      </div>

      <div class="car-card">
        <div class="img-container">
          <img
            src="/images/Novo-Gol-2013-Bluemotion-traseira-2.jpg"
            alt="Gol G6"
          />
          <span class="badge">Seminovo</span>
        </div>
        <div class="car-info">
          <h2>VOLKSWAGEN GOL G6</h2>
          <p class="subtitle">1.6 Manual</p>
          <div class="details">
            <span>üìÖ 2019</span>
            <span>‚è±Ô∏è 50.000 Km</span>
          </div>
          <p class="price">R$ 54.900</p>
          <button class="offer-btn">Ver Detalhes</button>
        </div>
      </div>
    </div>

    <div class="social-float">
      <i class="fas fa-share-alt"></i>
      <div class="social-popup">
        <a
          href="https://www.facebook.com/MCMULTICARROS/"
          target="_blank"
          class="social-link facebook"
        >
          <i class="fab fa-facebook-f"></i>
        </a>
        <a
          href="https://www.instagram.com/multicarrosveiculos/"
          target="_blank"
          class="social-link instagram"
        >
          <i class="fab fa-instagram"></i>
        </a>
      </div>
    </div>

    <!-- WHATSAPP FIXO -->
    <a href="https://wa.me/5561981419150" class="whatsapp" target="_blank"
      >üí¨</a
    >

    <section class="vantagens">
      <h2>Por que escolher a <span>Multicarros</span>?</h2>
      <div class="vantagens-container">
        <div class="vantagem-card">
          <i class="fa-solid fa-car"></i>
          <h3>Ve√≠culos Inspecionados</h3>
          <p>
            Todos os nossos carros passam por uma rigorosa avalia√ß√£o mec√¢nica e
            de proced√™ncia.
          </p>
        </div>
        <div class="vantagem-card">
          <i class="fa-solid fa-money-bill-wave"></i>
          <h3>Melhor Avalia√ß√£o</h3>
          <p>
            Oferecemos o melhor pre√ßo do mercado e condi√ß√µes de pagamento
            acess√≠veis.
          </p>
        </div>
        <div class="vantagem-card">
          <i class="fa-solid fa-handshake"></i>
          <h3>Confian√ßa e Garantia</h3>
          <p>
            Com anos de experi√™ncia, garantimos transpar√™ncia e confian√ßa em
            cada negocia√ß√£o.
          </p>
        </div>
        <div class="vantagem-card">
          <i class="fa-solid fa-users"></i>
          <h3>Atendimento Personalizado</h3>
          <p>
            Nosso time est√° pronto para te atender, al√©m do nosso Atendimento
            24H.
          </p>
        </div>
      </div>
    </section>

    <section class="mapa">
      <h2>üìç Encontre a Multicarros !</h2>
      <p>Venha nos visitar e fa√ßa um test drive!</p>
      <div class="mapa-container">
        <iframe
          src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d3838.398295547115!2d-48.0669156!3d-15.811891!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x935a333c90e88e27%3A0x83aa09beb7b37e9d!2sMulticarros!5e0!3m2!1spt-BR!2sbr!4v1698798920146!5m2!1spt-BR!2sbr"
          width="100%"
          height="400"
          style="border: 0"
          allowfullscreen=""
          loading="lazy"
        >
        </iframe>
      </div>
    </section>

    <!-- RODAP√â -->
    <footer class="rodape">
      <div class="rodape-conteudo">
        <!-- Coluna 1 -->
        <div class="rodape-coluna">
          <img
            src="/images/multilogo.png"
            alt="Logo Multicarros"
            class="rodape-logo"
          />
          <p>üìç QNE 7, Loja 19/20 , Taguatinga norte - Brasilia/DF</p>
          <p>üìû (61) 3352-2619 | üì± (61) 98400-0200</p>
          <p>‚úâÔ∏è vendas@multicarros.com.br</p>
        </div>

        <div class="rodape-coluna">
          <h4>Hor√°rio de Atendimento</h4>
          <p>Segunda a Sexta: 8h - 18h</p>
          <p>S√°bado: 8h - 13h</p>
          <p>Domingo: Fechado</p>
        </div>

        <!-- Coluna 2 -->
        <div class="rodape-coluna">
          <h4>Links R√°pidos</h4>
          <a href="/HTML/index.html">Home</a>
          <a href="/HTML/financiamento.html">Financiamento</a>
          <a href="/HTML/sobreEmpresa.html">Sobre a Empresa</a>
          <a href="/HTML/contato.html">Contato</a>
        </div>

        <!-- Coluna 3 -->
        <div class="rodape-coluna">
          <h4>Siga-nos</h4>
          <a href="https://www.facebook.com/MCMULTICARROS/">üîó Facebook</a>
          <a href="https://www.instagram.com/multicarrosveiculos/"
            >üîó Instagram</a
          >
          <a href="https://wa.me/55619840002200">üí¨ WhatsApp</a>
        </div>
      </div>

      <div class="rodape-bottom">
        <p>¬© 2025 Multicarros. Todos os direitos reservados.</p>
      </div>
    </footer>
    <script src="/js/redesSociais.js"></script>
    <script src="/js/home.js"></script>

    <!-- Script para anima√ß√£o do √≠cone de pesquisa -->
    <script>
      const iconePesquisa = document.querySelector(".icone-pesquisa");
      const barraPesquisa = document.querySelector(".barra-pesquisa");

      barraPesquisa.addEventListener("focus", () => {
        iconePesquisa.style.transform = "scale(1.2)";
        setTimeout(() => (iconePesquisa.style.transform = "scale(1)"), 150);
      });
    </script>

    //-- Script para carregar marcas dinamicamente --//
    <script>
      (function () {
        const btn = document.getElementById("btnMarcas");
        const lista = document.getElementById("listaMarcas");
        if (!btn || !lista) return;

        const endpoint =
          document.body.dataset.apiVeiculos || "http://localhost:3000/veiculos";

        function textNodesToArray(list) {
          return Array.from(list.querySelectorAll("li a"))
            .map((a) => a.textContent.trim())
            .filter(Boolean);
        }

        function escapeHtml(s) {
          return String(s || "");
        }

        // Load brands from existing static list first
        const existing = new Set(textNodesToArray(lista));

        // Fetch vehicles and derive brands
        fetch(endpoint, {method: "GET"})
          .then((res) => {
            if (!res.ok)
              throw new Error("Erro ao buscar ve√≠culos: " + res.status);
            return res.json();
          })
          .then((data) => {
            if (!Array.isArray(data)) return;
            data.forEach((v) => {
              let brand = (v.marca || v.brand || v.make || "").trim();
              if (!brand && v.marcaModelo) {
                // try to extract brand from combined field
                const mm = String(v.marcaModelo || "").trim();
                if (mm) {
                  // prefer part before first space or before a dash
                  brand = mm
                    .split(/[\-‚Äì‚Äî]/)[0]
                    .trim()
                    .split(" ")[0];
                }
              }
              if (!brand && v.modelo) brand = String(v.modelo).split(" ")[0];
              if (brand) existing.add(brand);
            });

            // render sorted list
            const sorted = Array.from(existing).sort((a, b) =>
              a.localeCompare(b, "pt-BR", {sensitivity: "base"})
            );
            lista.innerHTML = "";
            sorted.forEach((b) => {
              const li = document.createElement("li");
              const a = document.createElement("a");
              a.href = "#";
              a.textContent = escapeHtml(b);
              li.appendChild(a);
              lista.appendChild(li);
            });
          })
          .catch((err) => {
            console.warn(
              "N√£o foi poss√≠vel carregar marcas dinamicamente:",
              err
            );
          });

        // keep simple toggle behavior (some CSS may rely on this)
        btn.addEventListener("click", function (e) {
          e.preventDefault();
          lista.classList.toggle("open");
        });
      })();
    </script>

    //-- script para busca de ve√≠culos na barra de pesquisa --//
    <script>
      // üîç Script para busca de ve√≠culos na barra de pesquisa
(function () {
  const input = document.querySelector(".barra-pesquisa");
  const endpoint = "http://localhost:3000/veiculos-com-fotos";
  
  const destaqueEl = document.getElementById("destaqueContainer");
  const estoqueEl = document.getElementById("estoqueContainer");
  
  if (!input || !destaqueEl || !estoqueEl) {
    console.warn("‚ö†Ô∏è Elementos de busca n√£o encontrados");
    return;
  }

  function escapeHtml(s) {
    return String(s || "");
  }

  // üé® Mesma fun√ß√£o makeCard (mant√©m consist√™ncia)
  function makeCard(v) {
    const imgSrc = v.foto_principal 
      || (v.fotos && v.fotos[0] && v.fotos[0].url) 
      || "/images/default-car.jpg";
    
    let badge = "Dispon√≠vel";
    if (v.status === "novo") badge = "Novo!";
    else if (v.status === "usado") badge = "Seminovo";
    
    const nomeCompleto = `${v.marca || ""} ${v.modelo || ""}`.trim() || "Ve√≠culo";
    const subtitle = v.cambio ? `${v.cambio === "automatico" ? "Autom√°tico" : "Manual"}` : "";
    const ano = v.fabricacao || v.ano_modelo || "";
    const km = v.km ? `${Number(v.km).toLocaleString("pt-BR")} Km` : "";
    const preco = v.preco 
      ? `R$ ${Number(v.preco).toLocaleString("pt-BR", { minimumFractionDigits: 2 })}` 
      : "Consulte";
    const id = v.id || "";

    const card = document.createElement("div");
    card.className = "car-card";
    card.innerHTML = `
      <div class="img-container">
        <img 
          src="${escapeHtml(imgSrc)}" 
          alt="${escapeHtml(nomeCompleto)}" 
          onerror="this.src='/images/default-car.jpg'"
        />
        <span class="badge">${escapeHtml(badge)}</span>
      </div>
      <div class="car-info">
        <h2>${escapeHtml(nomeCompleto)}</h2>
        <p class="subtitle">${escapeHtml(subtitle)}</p>
        <div class="details">
          <span>üìÖ ${escapeHtml(ano)}</span>
          <span>‚è±Ô∏è ${escapeHtml(km)}</span>
        </div>
        <p class="price">${escapeHtml(preco)}</p>
        <button 
          class="offer-btn" 
          onclick="window.location.href='/HTML/verDetalhes.html${id ? "?id=" + encodeURIComponent(id) : ""}'">
          Ver Detalhes
        </button>
      </div>
    `;
    return card;
  }

  let lastQuery = "";
  let timeout = null;

  // üîç Fun√ß√£o de busca
  function performSearch(q) {
    const qTrim = String(q || "").trim().toLowerCase();
    
    console.log(`üîç Buscando por: "${qTrim}"`);

    fetch(endpoint, { method: "GET" })
      .then((res) => {
        if (!res.ok) throw new Error("status " + res.status);
        return res.json();
      })
      .then((data) => {
        if (!Array.isArray(data)) return;

        // üéØ Filtra resultados se houver termo de busca
        let resultados = data;
        
        if (qTrim) {
          resultados = data.filter((v) => {
            const marca = String(v.marca || "").toLowerCase();
            const modelo = String(v.modelo || "").toLowerCase();
            const ano = String(v.fabricacao || v.ano_modelo || "");
            const cor = String(v.cor || "").toLowerCase();
            
            return (
              marca.includes(qTrim) ||
              modelo.includes(qTrim) ||
              ano.includes(qTrim) ||
              cor.includes(qTrim)
            );
          });
          
          console.log(`‚úÖ ${resultados.length} resultado(s) encontrado(s)`);
        }

        // üéØ Separa destaque e estoque
        const destaque = resultados.filter(v => v.status === "novo");
        const restante = resultados.filter(v => v.status !== "novo");
        const destaqueList = destaque.length > 0 
          ? destaque.slice(0, 6) 
          : resultados.slice(0, 4);

        // üßπ Limpa e renderiza
        destaqueEl.innerHTML = "";
        estoqueEl.innerHTML = "";
        
        if (resultados.length === 0) {
          destaqueEl.innerHTML = `<p style="grid-column: 1/-1; text-align: center; padding: 2rem;">
            Nenhum ve√≠culo encontrado para "${escapeHtml(qTrim)}"
          </p>`;
        } else {
          destaqueList.forEach((v) => destaqueEl.appendChild(makeCard(v)));
          restante.forEach((v) => estoqueEl.appendChild(makeCard(v)));
        }
      })
      .catch((err) => {
        console.error("‚ùå Erro na busca:", err);
      });
  }

  // üéß Event listeners
  input.addEventListener("input", function (e) {
    const q = e.target.value;
    if (q === lastQuery) return;
    lastQuery = q;
    clearTimeout(timeout);
    timeout = setTimeout(() => performSearch(q), 300);
  });

  input.addEventListener("keydown", function (e) {
    if (e.key === "Enter") {
      e.preventDefault();
      clearTimeout(timeout);
      performSearch(this.value);
    }
  });
})();
    </script>


    //-- script para cards de ve√≠culos --//
    <script>
      (function () {
  // ‚úÖ ENDPOINT CORRETO: usa /veiculos-com-fotos para pegar ve√≠culos com suas fotos
  const endpoint = "http://localhost:3000/veiculos-com-fotos";
  
  const destaqueEl = document.getElementById("destaqueContainer");
  const estoqueEl = document.getElementById("estoqueContainer");
  
  if (!destaqueEl || !estoqueEl) {
    console.warn("‚ö†Ô∏è Containers n√£o encontrados no DOM");
    return;
  }

  // üõ°Ô∏è Fun√ß√£o para escapar HTML e prevenir XSS
  function escapeHtml(s) {
    return String(s || "");
  }

  // üé® Fun√ß√£o para criar um card de ve√≠culo
  function makeCard(v) {
    // üì∏ ORDEM DE PRIORIDADE PARA FOTO
    // 1¬∫: foto_principal (vem do service)
    // 2¬∫: primeira foto do array fotos
    // 3¬∫: imagem padr√£o
    const imgSrc = v.foto_principal 
      || (v.fotos && v.fotos[0] && v.fotos[0].url) 
      || "/images/default-car.jpg";
    
    // üè∑Ô∏è Badge baseado no status
    let badge = "Dispon√≠vel";
    if (v.status === "novo") {
      badge = "Novo!";
    } else if (v.status === "usado") {
      badge = "Seminovo";
    }
    
    // üöó Monta o nome completo do ve√≠culo
    const nomeCompleto = `${v.marca || ""} ${v.modelo || ""}`.trim() || "Ve√≠culo";
    
    // üîß Motor/Cambio como subt√≠tulo
    const subtitle = v.cambio 
      ? `${v.cambio === "automatico" ? "Autom√°tico" : "Manual"}` 
      : "";
    
    // üìÖ Ano
    const ano = v.fabricacao || v.ano_modelo || "";
    
    // üõ£Ô∏è Quilometragem formatada
    const km = v.km 
      ? `${Number(v.km).toLocaleString("pt-BR")} Km` 
      : "";
    
    // üí∞ Pre√ßo formatado
    const preco = v.preco 
      ? `R$ ${Number(v.preco).toLocaleString("pt-BR", { minimumFractionDigits: 2 })}` 
      : "Consulte";
    
    // üÜî ID do ve√≠culo
    const id = v.id || "";

    // üèóÔ∏è Cria o elemento do card
    const card = document.createElement("div");
    card.className = "car-card";
    card.innerHTML = `
      <div class="img-container">
        <img 
          src="${escapeHtml(imgSrc)}" 
          alt="${escapeHtml(nomeCompleto)}" 
          onerror="this.src='/images/default-car.jpg'"
        />
        <span class="badge">${escapeHtml(badge)}</span>
      </div>
      <div class="car-info">
        <h2>${escapeHtml(nomeCompleto)}</h2>
        <p class="subtitle">${escapeHtml(subtitle)}</p>
        <div class="details">
          <span>üìÖ ${escapeHtml(ano)}</span>
          <span>‚è±Ô∏è ${escapeHtml(km)}</span>
        </div>
        <p class="price">${escapeHtml(preco)}</p>
        <button 
          class="offer-btn" 
          onclick="window.location.href='/HTML/verDetalhes.html${id ? "?id=" + encodeURIComponent(id) : ""}'">
          Ver Detalhes
        </button>
      </div>
    `;
    return card;
  }

  // üåê Busca os ve√≠culos da API
  console.log("üì° Buscando ve√≠culos da API...");
  
  fetch(endpoint, { method: "GET" })
    .then((res) => {
      if (!res.ok) {
        throw new Error(`Erro HTTP: ${res.status}`);
      }
      return res.json();
    })
    .then((data) => {
      console.log(`‚úÖ ${data.length} ve√≠culos recebidos da API`);
      
      if (!Array.isArray(data) || data.length === 0) {
        console.warn("‚ö†Ô∏è Nenhum ve√≠culo encontrado");
        destaqueEl.innerHTML = "<p>Nenhum ve√≠culo dispon√≠vel no momento.</p>";
        return;
      }

      // üéØ Separa ve√≠culos em destaque e estoque
      // Crit√©rio: status = 'novo' vai para destaque
      const destaque = data.filter(v => v.status === "novo");
      const restante = data.filter(v => v.status !== "novo");
      
      // Se n√£o houver ve√≠culos novos, pega os primeiros 4 como destaque
      const destaqueList = destaque.length > 0 
        ? destaque.slice(0, 6) 
        : data.slice(0, 4);

      console.log(`üåü ${destaqueList.length} ve√≠culos em destaque`);
      console.log(`üì¶ ${restante.length} ve√≠culos em estoque`);

      // üßπ Limpa containers (remove cards est√°ticos do HTML)
      destaqueEl.innerHTML = "";
      estoqueEl.innerHTML = "";

      // üé® Renderiza os cards
      destaqueList.forEach((v) => {
        destaqueEl.appendChild(makeCard(v));
      });

      restante.forEach((v) => {
        estoqueEl.appendChild(makeCard(v));
      });
      
      console.log("üéâ Ve√≠culos carregados com sucesso!");
    })
    .catch((err) => {
      console.error("‚ùå Erro ao carregar ve√≠culos:", err);
      destaqueEl.innerHTML = "<p>Erro ao carregar ve√≠culos. Tente novamente mais tarde.</p>";
    });
})();
    </script>
  </body>
</html>
